<Page x:Class="Chefs.Views.RecipeDetailsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Chefs.Views"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:uer="using:Uno.Extensions.Reactive.UI"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:uen="using:Uno.Extensions.Navigation.UI"
      mc:Ignorable="d"
      NavigationCacheMode="Enabled"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
      VerticalAlignment="Stretch"
      HorizontalAlignment="Stretch">

    <utu:AutoLayout Background="{ThemeResource BackgroundBrush}">
        <utu:AutoLayout.Resources>
            <x:String x:Key="BitmapIcon_Outline_Share_ChefsApp">F0 M 11 3.25 C 11 1.4550745487213135 12.455074310302734 0 14.25 0 C 16.044925689697266 0 17.5 1.4550745487213135 17.5 3.25 C 17.5 5.044925212860107 16.044925689697266 6.5 14.25 6.5 C 13.290374755859375 6.5 12.427888870239258 6.08409309387207 11.832966804504395 5.422702312469482 L 9.1156644821167 6.904867172241211 L 6.07514762878418 8.642305374145508 C 6.345523357391357 9.116405487060547 6.5 9.665163040161133 6.5 10.25 C 6.5 10.54634952545166 6.4603352546691895 10.833434104919434 6.386025905609131 11.106236457824707 L 11.832967758178711 14.077296257019043 C 12.427889823913574 13.415905952453613 13.290374755859375 13 14.25 13 C 16.044925689697266 13 17.5 14.455074310302734 17.5 16.25 C 17.5 18.044925689697266 16.044925689697266 19.5 14.25 19.5 C 12.455074310302734 19.5 11 18.044925689697266 11 16.25 C 11 15.953645706176758 11.039665222167969 15.666556358337402 11.113977432250977 15.393750190734863 L 5.667040824890137 12.422694206237793 C 5.072118282318115 13.084090232849121 4.209629535675049 13.5 3.25 13.5 C 1.4550745487213135 13.5 0 12.044925689697266 0 10.25 C 0 8.455074310302734 1.4550745487213135 7 3.25 7 C 3.9006779193878174 7 4.50669527053833 7.191215991973877 5.014923572540283 7.5205206871032715 L 8.38434886932373 5.59513521194458 L 11.11397647857666 4.106247425079346 C 11.039665222167969 3.833442211151123 11 3.546353340148926 11 3.25 Z M 14.25 1.5 C 13.283501625061035 1.5 12.5 2.283501625061035 12.5 3.25 C 12.5 4.216498374938965 13.283501625061035 5 14.25 5 C 15.216498374938965 5 16 4.216498374938965 16 3.25 C 16 2.283501625061035 15.216498374938965 1.5 14.25 1.5 Z M 3.25 8.5 C 2.283501625061035 8.5 1.5 9.283501625061035 1.5 10.25 C 1.5 11.216498374938965 2.283501625061035 12 3.25 12 C 4.216498374938965 12 5 11.216498374938965 5 10.25 C 5 9.283501625061035 4.216498374938965 8.5 3.25 8.5 Z M 12.5 16.25 C 12.5 15.283501625061035 13.283501625061035 14.5 14.25 14.5 C 15.216498374938965 14.5 16 15.283501625061035 16 16.25 C 16 17.21649932861328 15.216498374938965 18 14.25 18 C 13.283501625061035 18 12.5 17.21649932861328 12.5 16.25 Z</x:String>
            <x:String x:Key="BitmapIcon_Outline_Status_Bookmark">F0 M 11.022966384887695 1.8260469436645508 C 8.429844856262207 1.3913177847862244 5.7677321434021 1.3913177847862244 3.1746108531951904 1.8260469436645508 C 2.6866114139556885 1.9078586101531982 2.2990212440490723 2.2827858924865723 2.2017436027526855 2.7657222747802734 C 1.3166660070419312 7.159704208374023 1.2683736085891724 11.681201934814453 2.0593996047973633 16.09308624267578 L 2.2229490280151367 17.005268096923828 L 5.893476963043213 13.518265724182129 C 6.568917274475098 12.87659740447998 7.628660202026367 12.876598358154297 8.304100036621094 13.518265724182129 L 11.974628448486328 17.005268096923828 L 12.138177871704102 16.09308624267578 C 12.929203033447266 11.681203842163086 12.880910873413086 7.1597020626068115 11.995833396911621 2.7657220363616943 C 11.898555755615234 2.2827858924865723 11.510966300964355 1.9078586101531982 11.022966384887695 1.8260469436645508 Z M 2.9266014099121094 0.34669187664985657 C 5.6839165687561035 -0.11556392908096313 8.513660430908203 -0.11556395888328552 11.270975112915039 0.3466918170452118 C 12.370189666748047 0.5309718549251556 13.245786666870117 1.3747867345809937 13.466299057006836 2.469527006149292 C 14.388627052307129 7.048438787460327 14.43895149230957 11.76024055480957 13.614633560180664 16.357807159423828 L 13.393149375915527 17.593116760253906 C 13.20724868774414 18.629966735839844 11.943209648132324 19.044387817382812 11.179508209228516 18.318870544433594 L 7.270976543426514 14.605765342712402 C 7.174484729766846 14.514098167419434 7.023092746734619 14.514098167419434 6.926601409912109 14.605765342712402 L 3.0180697441101074 18.318870544433594 C 2.254368782043457 19.04438591003418 0.9903291463851929 18.629966735839844 0.8044277429580688 17.593116760253906 L 0.582943320274353 16.357805252075195 C -0.24137496948242188 11.760236740112305 -0.19105017185211182 7.04844069480896 0.731278121471405 2.469527006149292 C 0.9517910480499268 1.3747873306274414 1.8273870944976807 0.5309719145298004 2.9266014099121094 0.34669187664985657 Z</x:String>
        </utu:AutoLayout.Resources>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="Narrow" />
                <VisualState x:Name="Wide">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="800" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="ContentLayout.Orientation"
                                Value="Horizontal" />
                        <Setter Target="ButtonsLayout.Orientation"
                                Value="Horizontal" />
                        <Setter Target="ButtonsLayout.PrimaryAxisAlignment"
                                Value="End" />
                        <Setter Target="ButtonsLayout.Padding"
                                Value="40,18" />
                        <Setter Target="ButtonsLayout.Spacing"
                                Value="40" />
                        <Setter Target="ButtonsLayout.Background"
                                Value="{ThemeResource SurfaceColor}" />
                        <Setter Target="DetailsTab.Visibility"
                                Value="Collapsed" />
                        <Setter Target="WideDetailsLayout.Visibility"
                                Value="Visible" />
                        <Setter Target="CreatorLayout.Visibility"
                                Value="Collapsed" />
                        <Setter Target="RecipeImage.MaxHeight"
                                Value="300" />
                        <Setter Target="RecipeImage.Margin"
                                Value="40,0,20,0" />
                        <Setter Target="RecipeImage.CornerRadius"
                                Value="40" />
                        <Setter Target="TabsLayout.Padding"
                                Value="20,0,40,20" />
                        <Setter Target="IngredientsButton.(utu:AutoLayout.PrimaryLength)"
                                Value="190" />
                        <Setter Target="IngredientsButton.(utu:AutoLayout.CounterLength)"
                                Value="56" />
                        <Setter Target="IngredientsButton.Foreground"
                                Value="{ThemeResource OnSurfaceMediumBrush}" />
                        <Setter Target="IngredientsButton.Style"
                                Value="{StaticResource OutlinedButtonStyle}" />
                        <Setter Target="LiveCookingButton.(utu:AutoLayout.PrimaryLength)"
                                Value="190" />
                        <Setter Target="LiveCookingButton.(utu:AutoLayout.CounterLength)"
                                Value="56" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <utu:AutoLayout utu:AutoLayout.PrimaryAlignment="Stretch">
            <utu:NavigationBar Background="{ThemeResource BackgroundBrush}"
                               Style="{StaticResource NavigationBarStyle}"
                               Content="{Binding Recipe.Name}">
                <utu:NavigationBar.PrimaryCommands>
                    <AppBarButton uen:Navigation.Request="-">
                        <AppBarButton.Icon>
                            <BitmapIcon ShowAsMonochrome="False"
                                        UriSource="ms-appx:///Assets/Icons/share.png" />
                        </AppBarButton.Icon>
                    </AppBarButton>
                    <AppBarButton>
                        <AppBarButton.Icon>
                            <BitmapIcon ShowAsMonochrome="False"
                                        UriSource="ms-appx:///Assets/Icons/bookmark.png" />
                        </AppBarButton.Icon>
                    </AppBarButton>
                </utu:NavigationBar.PrimaryCommands>
            </utu:NavigationBar>
            <ScrollViewer x:Name="MainScrollViewer"
                          utu:AutoLayout.PrimaryAlignment="Stretch"
                          HorizontalScrollMode="Disabled">
                <utu:AutoLayout x:Name="ContentLayout">
                    <utu:AutoLayout x:Name="ImageLayout"
                                    PrimaryAxisAlignment="Center"
                                    utu:AutoLayout.PrimaryAlignment="Stretch"
                                    utu:AutoLayout.CounterAlignment="Stretch">
                        <utu:AutoLayout x:Name="CreatorLayout"
                                        Spacing="6"
                                        Padding="18,20"
                                        Orientation="Horizontal">
                            <PersonPicture utu:AutoLayout.CounterAlignment="Center"
                                           Width="32"
                                           Height="32"
                                           ProfilePicture="{Binding User.UrlProfileImage}" />
                            <TextBlock Text="{Binding User.FullName, Converter={StaticResource StringFormatter}, ConverterParameter='By {0}'}"
                                       utu:AutoLayout.CounterAlignment="Center"
                                       Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                       Style="{StaticResource TitleSmall}" />
                        </utu:AutoLayout>
                        <utu:AutoLayout Spacing="-35"
                                        PrimaryAxisAlignment="Center"
                                        utu:AutoLayout.PrimaryAlignment="Stretch">
                            <utu:AutoLayout x:Name="RecipeImage">
                                <Image Source="{Binding Recipe.ImageUrl}"
                                       Stretch="UniformToFill"
                                       utu:AutoLayout.CounterAlignment="Stretch" />
                            </utu:AutoLayout>
                            <utu:AutoLayout Background="{ThemeResource OnPrimaryBrush}"
                                            Spacing="40"
                                            Padding="40,14"
                                            CornerRadius="16"
                                            PrimaryAxisAlignment="Center"
                                            Orientation="Horizontal"
                                            utu:AutoLayout.CounterAlignment="Center">
                                <utu:AutoLayout Spacing="6"
                                                utu:AutoLayout.CounterAlignment="Center">
                                    <TextBlock Text="🕓"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Style="{StaticResource HeadlineMedium}" />
                                    <TextBlock Text="{Binding Recipe.CookTime, Converter={StaticResource TimeSpanToStringConverter}}"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Foreground="{ThemeResource SurfaceInverseBrush}"
                                               Style="{StaticResource TitleSmall}" />
                                </utu:AutoLayout>
                                <utu:AutoLayout Spacing="6"
                                                PrimaryAxisAlignment="Center"
                                                utu:AutoLayout.CounterAlignment="Center">
                                    <TextBlock Text="👥"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Foreground="{ThemeResource SurfaceInverseBrush}"
                                               Style="{StaticResource HeadlineMedium}" />
                                    <TextBlock Text="{Binding Recipe.Serves, Converter={StaticResource StringFormatter},ConverterParameter='Serves {0}'}"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Foreground="{ThemeResource SurfaceInverseBrush}"
                                               Style="{StaticResource TitleSmall}" />
                                </utu:AutoLayout>
                                <utu:AutoLayout Spacing="6"
                                                utu:AutoLayout.CounterAlignment="Center">
                                    <TextBlock Text="🔥"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Style="{StaticResource HeadlineMedium}" />
                                    <TextBlock Text="{Binding Recipe.Difficulty}"
                                               utu:AutoLayout.CounterAlignment="Center"
                                               Foreground="{ThemeResource SurfaceInverseBrush}"
                                               Style="{StaticResource TitleSmall}" />
                                </utu:AutoLayout>
                            </utu:AutoLayout>
                        </utu:AutoLayout>
                        <utu:AutoLayout x:Name="WideDetailsLayout"
                                        Visibility="Collapsed"
                                        Spacing="20"
                                        Padding="40,0">
                            <utu:AutoLayout Spacing="6"
                                            Orientation="Horizontal">
                                <PersonPicture utu:AutoLayout.CounterAlignment="Center"
                                               Width="32"
                                               Height="32"
                                               ProfilePicture="{Binding User.UrlProfileImage}" />
                                <TextBlock Text="{Binding User.FullName, Converter={StaticResource StringFormatter}, ConverterParameter='By {0}'}"
                                           utu:AutoLayout.CounterAlignment="Center"
                                           Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                           Style="{StaticResource TitleSmall}" />
                            </utu:AutoLayout>
                            <TextBlock Foreground="{ThemeResource SurfaceInverseBrush}"
                                       TextWrapping="Wrap"
                                       Text="{Binding Steps.Count, Converter={StaticResource StringFormatter},ConverterParameter='{}{0} Items'}"
                                       Style="{StaticResource HeadlineMedium}" />
                            <utu:AutoLayout utu:AutoLayout.PrimaryAlignment="Stretch">
                                <uer:FeedView Source="{Binding Steps}">
                                    <DataTemplate>
                                        <ListView ItemsSource="{Binding Data}"
                                                  Style="{StaticResource ListViewStyle}">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <utu:AutoLayout Background="{ThemeResource SurfaceBrush}"
                                                                    CornerRadius="15"
                                                                    Margin="-10,8">
                                                        <utu:AutoLayout Padding="16,18"
                                                                        PrimaryAxisAlignment="Center">
                                                            <TextBlock Foreground="{ThemeResource OnSurfaceBrush}"
                                                                       TextWrapping="Wrap"
                                                                       Text="{Binding Number, Converter={StaticResource StringFormatter}, ConverterParameter='Step {0}'}"
                                                                       Style="{StaticResource TitleMedium}" />
                                                            <TextBlock Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                                                       TextWrapping="Wrap"
                                                                       Text="{Binding Description}"
                                                                       Style="{StaticResource LabelSmall}" />
                                                        </utu:AutoLayout>
                                                    </utu:AutoLayout>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </DataTemplate>
                                </uer:FeedView>
                            </utu:AutoLayout>
                        </utu:AutoLayout>
                    </utu:AutoLayout>
                    <utu:AutoLayout x:Name="TabsLayout"
                                    uen:Region.Attached="True"
                                    Spacing="16"
                                    Padding="18,30"
                                    utu:AutoLayout.PrimaryAlignment="Stretch"
                                    utu:AutoLayout.CounterAlignment="Stretch">
                        <utu:TabBar uen:Region.Attached="True"
                                    SelectedItem="{Binding ElementName=IngredientsTabItem}"
                                    Style="{StaticResource TopTabBarStyle}">
                            <utu:TabBarItem x:Name="IngredientsTabItem"
                                            Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                            Content="Ingredients"
                                            uen:Region.Name="IngredientsTab" />
                            <utu:TabBarItem x:Name="DetailsTab"
                                            Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                            Content="Details"
                                            uen:Region.Name="DetailsTab" />
                            <utu:TabBarItem Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                            Content="Reviews"
                                            uen:Region.Name="ReviewsTab" />
                        </utu:TabBar>
                        <Grid uen:Region.Attached="True"
                              uen:Region.Navigator="Visibility">

                            <utu:AutoLayout uen:Region.Name="IngredientsTab"
                                            Visibility="Visible">
                                <TextBlock Foreground="{ThemeResource SurfaceInverseBrush}"
                                           TextWrapping="Wrap"
                                           Text="{Binding Ingredients.Count, Converter={StaticResource StringFormatter},ConverterParameter='{}{0} Items'}"
                                           Style="{StaticResource HeadlineMedium}" />
                                <utu:AutoLayout utu:AutoLayout.PrimaryAlignment="Stretch">

                                    <uer:FeedView x:Name="IngredientsFeed"
                                                  Source="{Binding Ingredients}">
                                        <DataTemplate>
                                            <ListView ItemsSource="{Binding Data}"
                                                      Style="{StaticResource ListViewStyle}">
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <utu:AutoLayout Background="{ThemeResource SurfaceBrush}"
                                                                        CornerRadius="15"
                                                                        PrimaryAxisAlignment="Center"
                                                                        Margin="-10,8">
                                                            <utu:AutoLayout Spacing="16"
                                                                            Padding="16,18"
                                                                            Orientation="Horizontal">
                                                                <ImageIcon Source="{Binding UrlIcon}"
                                                                           utu:AutoLayout.CounterAlignment="Center"
                                                                           Margin="0, 0, 0, 3" />
                                                                <utu:AutoLayout utu:AutoLayout.CounterAlignment="Center"
                                                                                utu:AutoLayout.PrimaryAlignment="Stretch">
                                                                    <TextBlock Foreground="{ThemeResource OnSurfaceBrush}"
                                                                               TextWrapping="Wrap"
                                                                               Text="{Binding Name}"
                                                                               Style="{StaticResource TitleMedium}" />
                                                                </utu:AutoLayout>
                                                                <TextBlock Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                                                           TextAlignment="End"
                                                                           Text="{Binding Quantity}"
                                                                           utu:AutoLayout.CounterAlignment="Center" />
                                                            </utu:AutoLayout>
                                                        </utu:AutoLayout>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </DataTemplate>
                                    </uer:FeedView>
                                </utu:AutoLayout>
                            </utu:AutoLayout>

                            <utu:AutoLayout uen:Region.Name="DetailsTab"
                                            Visibility="Collapsed">
                                <TextBlock Foreground="{ThemeResource SurfaceInverseBrush}"
                                           TextWrapping="Wrap"
                                           Text="{Binding Steps.Count, Converter={StaticResource StringFormatter},ConverterParameter='{}{0} Items'}"
                                           Style="{StaticResource HeadlineMedium}" />
                                <utu:AutoLayout utu:AutoLayout.PrimaryAlignment="Stretch">
                                    <uer:FeedView x:Name="StepsFeed"
                                                  Source="{Binding Steps}">
                                        <DataTemplate>
                                            <ListView ItemsSource="{Binding Data}"
                                                      Style="{StaticResource ListViewStyle}">
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <utu:AutoLayout Background="{ThemeResource SurfaceBrush}"
                                                                        CornerRadius="15"
                                                                        Margin="-10,8">
                                                            <utu:AutoLayout Padding="16,18"
                                                                            PrimaryAxisAlignment="Center">
                                                                <TextBlock Foreground="{ThemeResource OnSurfaceBrush}"
                                                                           TextWrapping="Wrap"
                                                                           Text="{Binding Number, Converter={StaticResource StringFormatter}, ConverterParameter='Step {0}'}"
                                                                           Style="{StaticResource TitleMedium}" />
                                                                <TextBlock Foreground="{ThemeResource OnSurfaceMediumBrush}"
                                                                           TextWrapping="Wrap"
                                                                           Text="{Binding Description}"
                                                                           Style="{StaticResource LabelSmall}" />
                                                            </utu:AutoLayout>
                                                        </utu:AutoLayout>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </DataTemplate>
                                    </uer:FeedView>
                                </utu:AutoLayout>
                            </utu:AutoLayout>

                            <utu:AutoLayout uen:Region.Name="ReviewsTab"
                                            Visibility="Collapsed">
                                <utu:AutoLayout Orientation="Horizontal"
                                                Spacing="10">
                                    <TextBlock Foreground="{ThemeResource SurfaceInverseBrush}"
                                               TextWrapping="Wrap"
                                               Text="{Binding Reviews.Count, Converter={StaticResource StringFormatter},ConverterParameter='{}{0} Comments'}"
                                               utu:AutoLayout.CounterAlignment="Start"
                                               utu:AutoLayout.PrimaryAlignment="Stretch"
                                               Style="{StaticResource HeadlineMedium}" />
                                    <HyperlinkButton Content="Add comment"
                                                     utu:AutoLayout.CounterAlignment="Stretch"
                                                     Command="{Binding Review}" />
                                </utu:AutoLayout>
                                <uer:FeedView x:Name="ReviewsFeed"
                                              Source="{Binding Reviews}">
                                    <DataTemplate>
                                        <ListView ItemsSource="{Binding Data}"
                                                  Style="{StaticResource ListViewStyle}"
                                                  ItemTemplate="{StaticResource ReviewDataTemplate}" />
                                    </DataTemplate>
                                </uer:FeedView>
                            </utu:AutoLayout>
                        </Grid>

                    </utu:AutoLayout>
                </utu:AutoLayout>
            </ScrollViewer>
        </utu:AutoLayout>

        <utu:AutoLayout x:Name="ButtonsLayout"
                        Padding="18"
                        Spacing="16">
            <Button x:Name="IngredientsButton"
                    Content="Get the Ingredients"
                    utu:AutoLayout.PrimaryLength="56"
                    Style="{StaticResource TextButtonStyle}"
                    Command="{Binding IngredientsNavigation}" />

            <Button x:Name="LiveCookingButton"
                    Background="{ThemeResource PrimaryBrush}"
                    Content="Start cooking!"
                    utu:AutoLayout.PrimaryLength="56"
                    Command="{Binding LiveCooking}" />
        </utu:AutoLayout>
    </utu:AutoLayout>
</Page>
